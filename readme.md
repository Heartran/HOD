# HOD
## Overview
[ゲームプログラマになる前に覚えておきたい技術](https://www.amazon.co.jp/%E3%82%B2%E3%83%BC%E3%83%A0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9E%E3%81%AB%E3%81%AA%E3%82%8B%E5%89%8D%E3%81%AB%E8%A6%9A%E3%81%88%E3%81%A6%E3%81%8A%E3%81%8D%E3%81%9F%E3%81%84%E6%8A%80%E8%A1%93-%E5%B9%B3%E5%B1%B1-%E5%B0%9A/dp/4798021180/ref=sr_1_1?__mk_ja_JP=%E3%82%AB%E3%82%BF%E3%82%AB%E3%83%8A&keywords=%E3%82%B2%E3%83%BC%E3%83%A0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9E&qid=1569574303&s=books&sr=1-1)を改造し、[スクリプト言語による効率的ゲーム開発 C/C++へのLua組込み実践](https://www.amazon.co.jp/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E8%A8%80%E8%AA%9E%E3%81%AB%E3%82%88%E3%82%8B%E5%8A%B9%E7%8E%87%E7%9A%84%E3%82%B2%E3%83%BC%E3%83%A0%E9%96%8B%E7%99%BA-%E3%81%B8%E3%81%AELua%E7%B5%84%E8%BE%BC%E3%81%BF%E5%AE%9F%E8%B7%B5-GAME-DEVELOPER-%E6%B5%9C%E4%B8%AD/dp/4797348550)でluaを組み込み、MMD、MMEを使えるようにした。

## Demo
このDemoが重いです。ロードが完了するまでお待ちいただければ幸いです。
<img src="demo.gif" width="960" height="540" alt="demo">


## Description
 自分でゲームエンジンを作ってみたかった。
 一からゲームエンジンを作るのは大変すぎるので、ゲームプログラマになる前に覚えておきたい技術を改造して書くことにした。詳しい解説もあるのでC++でゲームがどう動いているのかを深く理解するのはこの選択肢が一番だと思った。ただ当初はここまで作り込む気は全くなかった。  
 
自分はプログラマなので素材をできるだけ流用したかった。よってMMD,MMEを組み込むことにした。どういうゲームを作りたいというのをあまり決めずに作ってしまったのが悪手だった。。  
さらにそこからゲームの仕様を決めずにLuaに仕様決定を任せた辺りが決定的な間違いだと思っています。
 意思決定をコンピュータに任せるのではなく前もって行うことが非常に重要だと感じています。  
   
 ただ、本を読んだり、様々なゲームを分析したり、ゲームデザインを勉強していて感じるのは面白いゲームを作るのは非常に難しいということ。
 仕様決定と面白いゲームデザイン、ここに大きくはまってしまったかなと思います。

## Feature
* MMD
 * pmd、vmdデータの読み込み
 * トゥーンレンダリング
 * セルフシャドウ
 * LPSM(Light Space Perspective Shadow Maps)
 * ディファードレンダリング
 * ポイントライト
 * IK(インバースキネマティクス)
 * シェーダー側でのボーンの操作
 * DrawCallを少なくした効率的なデータ構造
 * 物理演算
 * vmd形式のカメラの読み込み
 * アニメーションのブレンドウェイト

* MME
 * ディファードレンダリング
 * SSAO
 * AutoLuminus
* Lua
  * 組み込むことにより動的なレベルデザインがビルドなしで行えるようになった。

* Xファイルの読み込み、表示

* 字幕システム

* playerが視錐台からでないようにあたり判定チェック

* 設計について考えたこと
  * リソースシステムについて
    * ゲーム中でもできるだけ止まらないように
    * XmlFileLoaderでのモデル、当たり判定、GameObjectのパラメータのリソースの管理
    * Luaと組み合わせてステージのビルドなしの動的なレベルデザインの変更
  
  * ゲームオブジェクトを継承構造で持つかコンポーネント構造で持つか？
    * 当初は継承構造でやっていたがに2つ合わせたような感じにした。
    [参考: ゲームプログラミングC++](https://www.amazon.co.jp/%E3%82%B2%E3%83%BC%E3%83%A0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0C-Sanjay-Madhav/dp/4798157619)
    
  * 3つの数学ライブラリ(DirectX, BulletPhysics, GameLib)
      * 行列の 列優先表現、行優先表現の変換
      * 右手座標、左手座標
* フォルダ構成  
├Bin : Debug, Release毎の実行ファイル  
├Data : Gameデーター  
├Lib : 各種ライブラリ  
├Licence : 各種ライセンス、ファイル毎に置いておくとあとでまとめてみたいとき困るので  
├Media : 未加工のリソースファイル  
├Obj : Debug, Release毎の中間ファイル  
├Project : 各種プロジェクトファイル  
├Recycle Bin : ゴミ箱、再利用したくなるようなリソース、ソースコードをとりあえず入れておく  
├Script : Luaファイル  
├Shader : 各種シェーダー  
├Source : ソースコード  
└Tool : 各種ツール  


## Requirement
* lua 5.1
* bullet physics3 2.85
* boost 1.62
* Direct X
* GameLib(改良点あり)

